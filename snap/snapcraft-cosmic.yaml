name: gosh-fetch-cosmic
version: '2.0.0'
summary: Modern download manager for Linux (COSMIC)
description: |
  Gosh Fetch is a powerful and modern download manager for Linux with support
  for HTTP, HTTPS, and BitTorrent downloads. Built with libcosmic for a native
  COSMIC desktop experience.

  Features:
  - HTTP/HTTPS downloads with resume support
  - BitTorrent and magnet link support
  - Download scheduling and queue management
  - System tray integration
  - Modern, adaptive UI

grade: stable
confinement: strict
base: core24
compression: lzo

platforms:
  amd64:
  arm64:

apps:
  gosh-fetch-cosmic:
    command: usr/bin/gosh-fetch-cosmic
    desktop: usr/share/applications/io.github.gosh.Fetch.desktop
    plugs:
      - home
      - desktop
      - desktop-legacy
      - network
      - network-bind
      - removable-media
      - wayland
      - x11
      - opengl
    slots:
      - dbus-daemon
    common-id: io.github.gosh.Fetch

slots:
  dbus-daemon:
    interface: dbus
    bus: session
    name: io.github.gosh.Fetch

parts:
  gosh-fetch:
    plugin: rust
    source: .
    build-packages:
      - libxkbcommon-dev
      - libwayland-dev
      - libinput-dev
      - libudev-dev
      - libseat-dev
      - libdbus-1-dev
      - libpulse-dev
      - libexpat1-dev
      - libfontconfig-dev
      - libfreetype-dev
      - libssl-dev
      - libpipewire-0.3-dev
      - mesa-vulkan-drivers
      - libvulkan-dev
    stage-packages:
      - libxkbcommon0
      - libwayland-client0
      - libinput10
      - libudev1
      - libseat1
      - libdbus-1-3
      - libvulkan1
    rust-channel: stable
    rust-path:
      - crates/gosh-fetch-cosmic
    override-build: |
      craftctl default
      install -Dm644 ${CRAFT_PART_SRC}/gosh-fetch.desktop ${CRAFT_PART_INSTALL}/usr/share/applications/io.github.gosh.Fetch.desktop
      install -Dm644 ${CRAFT_PART_SRC}/io.github.gosh.Fetch.metainfo.xml ${CRAFT_PART_INSTALL}/usr/share/metainfo/io.github.gosh.Fetch.metainfo.xml
      install -Dm644 ${CRAFT_PART_SRC}/resources/io.github.gosh.Fetch.png ${CRAFT_PART_INSTALL}/usr/share/icons/hicolor/256x256/apps/io.github.gosh.Fetch.png
